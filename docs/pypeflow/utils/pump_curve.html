<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.5" />
<title>pypeflow.utils.pump_curve API documentation</title>
<meta name="description" content="Pump curve fitting and drawing â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pypeflow.utils.pump_curve</code></h1>
</header>
<section id="section-intro">
<h2 id="pump-curve-fitting-and-drawing">Pump curve fitting and drawing</h2>
<ul>
<li>Establish an equation for the pump curve from measured points on the curve in the pump's data sheet</li>
<li>Get the coefficients of the 2nd order polynomial describing the pump curve and determined via curve fitting</li>
<li>Draw the pump curve in a diagram</li>
</ul>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
## Pump curve fitting and drawing

- Establish an equation for the pump curve from measured points on the curve in the pump&#39;s data sheet
- Get the coefficients of the 2nd order polynomial describing the pump curve and determined via curve fitting
- Draw the pump curve in a diagram

&#34;&#34;&#34;
from typing import List, Tuple, Dict, Optional
import numpy as np
import quantities as qty
from nummath.interpolation import PolyFit
from nummath.graphing2 import LineGraph


class PumpCurve:

    def __init__(self, dest_units: Dict[str, str]):
        &#34;&#34;&#34;
        Create *PumpCurve* object.

        **Parameters:**

        - `dest_units`: (*Dict[str, str]*)&lt;br&gt;
        The measuring units in which the pump curve will be expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        self._meas_points: List[Tuple[qty.VolumeFlowRate, qty.Pressure]] = []
        self._dest_units: Dict[str, str] = dest_units
        self._coefficients: Optional[np.array] = None

    def add_measuring_points(self, points: List[Tuple[float, float]], units: Dict[str, str]):
        &#34;&#34;&#34;
        Add some data points taken from the pump curve in the data sheet. This will execute the curve fitting
        algorithm that approaches the pump curve with a 2nd order polynomial.

        **Parameters:**

        - `points`: (*List[Tuple[float, float]]*)&lt;br&gt;
        List of tuples. The 1st element of the tuple is flow rate, the 2nd element is pressure.
        - `units`: (*Dict[str, str]*)&lt;br&gt;
        Dictionary that contains the measuring units in which the values of the data points are expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        self._meas_points = [
            (qty.VolumeFlowRate(V, units[&#39;flow_rate&#39;]), qty.Pressure(p, units[&#39;pressure&#39;])) for V, p in points
        ]
        self._curve_fitting()

    def _curve_fitting(self):
        pf = PolyFit(
            x_data=[V(self._dest_units[&#39;flow_rate&#39;]) for V, _ in self._meas_points],
            y_data=[p(self._dest_units[&#39;pressure&#39;]) for _, p in self._meas_points],
            m=2
        )
        self._coefficients = pf.solve()

    def get_coefficients(self, units: Optional[Dict[str, str]] = None) -&gt; Optional[List[float]]:
        &#34;&#34;&#34;
        Get the coefficients of the 2nd order polynomial describing the pump curve.

        **Parameters:**

        - `units`: (*Optional[[Dict[str, str]]*)&lt;br&gt;
        Optional dictionary that contains the measuring units in which the returned coefficients must be expressed.
        Default is None, which means that the coefficients will be returned expressed in the measuring units passed in
        at the instantiation of the *PumpCurve* object. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        if units is not None:
            p_src = qty.Pressure(1.0, self._dest_units[&#39;pressure&#39;])
            V_src = qty.VolumeFlowRate(1.0, self._dest_units[&#39;flow_rate&#39;])
            p_des = p_src(units[&#39;pressure&#39;])
            V_des = V_src(units[&#39;flow_rate&#39;])
        else:
            p_des = 1.0
            V_des = 1.0
        a0 = self._coefficients[0] * p_des
        a1 = self._coefficients[1] * (p_des / V_des)
        a2 = self._coefficients[2] * (p_des / V_des ** 2)
        return [a0, a1, a2]

    def set_coefficients(self, coeff: Tuple[float, float, float], units: Dict[str, str]):
        &#34;&#34;&#34;
        Set the known coefficients of the 2nd order polynomial describing the pump curve.

        **Parameters:**

        - `coeff`: (*Tuple[float, float, float]*)&lt;br&gt;
        Tuple of 3 floats: a0, a1 and a2 as in the equation dp_pump = a0 + a1 * V + a2 * V **2
        - `units`: (*Dict[str, str]*)&lt;br&gt;
        Dictionary that contains the measuring units in which the pump coefficients are expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        p_src = qty.Pressure(1.0, units[&#39;pressure&#39;])
        V_src = qty.VolumeFlowRate(1.0, units[&#39;flow_rate&#39;])
        p_des = p_src(self._dest_units[&#39;pressure&#39;])
        V_des = V_src(self._dest_units[&#39;flow_rate&#39;])
        a0 = coeff[0] * p_des
        a1 = coeff[1] * (p_des / V_des)
        a2 = coeff[2] * (p_des / V_des ** 2)
        self._coefficients = np.array([a0, a1, a2])

    def create_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, num: int = 50):
        &#34;&#34;&#34;
        Calculate the pump curve between an initial and final flow rate.

        **Parameters:**

        - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
        - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
        - `num`: (*int*) = number of calculation points (default = 50)

        **Returns:** (*Tuple[np.array, np.array]*)
        Tuple with 1st element a numpy array of the flow rates and 2nd element a numpy array of the corresponding
        pressures, both expressed in the desired measuring units set at instantiation of the *PumpCurve*-object.

        &#34;&#34;&#34;
        V_i = V_initial(self._dest_units[&#39;flow_rate&#39;])
        V_f = V_final(self._dest_units[&#39;flow_rate&#39;])
        V = np.linspace(V_i, V_f, num, endpoint=True)
        a0 = self._coefficients[0]; a1 = self._coefficients[1]; a2 = self._coefficients[2]
        p = a0 + a1 * V + a2 * V ** 2
        return V, p

    def draw_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, **kwargs):
        &#34;&#34;&#34;
        Draw the calculated pump curve.

        **Parameters:**

        - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
        - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
        - `kwargs`: optional keyword arguments
            + `fig_size`: (*Tuple[float, float]*) = the width and height of the figure in inches
            + `dpi`: (*int*) = dots per inch of the figure
            + `num`: (*int*) = number of calculated points to draw
            + `V_step`: (*quantities.VolumeFlowRate*) = step between ticks on the flow rate axis of the diagram
            + `V_max`: (*quantities.VolumeFlowRate*) = the maximum flow rate shown on the axis
            + `p_step`: (*quantities.Pressure*) = step between ticks on the pressure axis of the diagram
            + `p_max`: (*quantities.Pressure*) = maximum pressure shown on the axis
            + `working_point`: (*Tuple[qty.VolumeFlowRate, qty.Pressure]*) = working point of the pump (shown as a red
            dot on the diagram)

        **Returns:** (*nummath.graphing2.LineGraph*)&lt;br&gt;
        Call show() on the returned *LineGraph* object to show the diagram.
        &#34;&#34;&#34;
        if self._coefficients is not None:
            fig_size: Tuple[int, int] = kwargs.get(&#39;fig_size&#39;, (6, 4))
            dpi: int = kwargs.get(&#39;dpi&#39;, 96)
            num: int = kwargs.get(&#39;num&#39;, 50)
            V_step: qty.VolumeFlowRate = kwargs.get(&#39;V_step&#39;)
            V_max: qty.VolumeFlowRate = kwargs.get(&#39;V_max&#39;)
            p_step: qty.Pressure = kwargs.get(&#39;p_step&#39;)
            p_max: qty.Pressure = kwargs.get(&#39;p_max&#39;)
            working_point: Tuple[qty.VolumeFlowRate, qty.Pressure] = kwargs.get(&#39;working_point&#39;)
            V, p = self.create_pump_curve(V_initial, V_final, num)
            graph = LineGraph(fig_size=fig_size, dpi=dpi)
            graph.add_dataset(name=&#34;pump curve&#34;, x1_data=V, y1_data=p)
            if self._meas_points:
                graph.add_dataset(
                    name=&#34;measured points&#34;,
                    x1_data=[V(self._dest_units[&#39;flow_rate&#39;]) for V, _ in self._meas_points],
                    y1_data=[p(self._dest_units[&#39;pressure&#39;]) for _, p in self._meas_points],
                    layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;}
                )
            if working_point:
                graph.add_dataset(
                    name=&#34;working point&#34;,
                    x1_data=working_point[0](self._dest_units[&#39;flow_rate&#39;]),
                    y1_data=working_point[1](self._dest_units[&#39;pressure&#39;]),
                    layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;, &#39;color&#39;: &#39;red&#39;}
                )
            graph.x1.set_title(f&#39;flow rate [{self._dest_units[&#34;flow_rate&#34;]}]&#39;)
            if V_max is not None and V_step is not None:
                graph.x1.scale(
                    lim_down=0.0,
                    lim_up=V_max(self._dest_units[&#39;flow_rate&#39;]),
                    step_size=V_step(self._dest_units[&#39;flow_rate&#39;])
                )
            graph.y1.set_title(f&#39;pressure [{self._dest_units[&#34;pressure&#34;]}]&#39;)
            if p_max is not None and p_step is not None:
                graph.y1.scale(
                    lim_down=0.0,
                    lim_up=p_max(self._dest_units[&#39;pressure&#39;]),
                    step_size=p_step(self._dest_units[&#39;pressure&#39;])
                )
            return graph

    def pump_head(self, V: qty.VolumeFlowRate) -&gt; qty.Pressure:
        &#34;&#34;&#34;
        Get the pump head (*quantities.Pressure*) if the flow rate (*quantities.VolumeFlowRate*) is given.

        &#34;&#34;&#34;
        a0 = self._coefficients[0]
        a1 = self._coefficients[1]
        a2 = self._coefficients[2]
        V = V(self._dest_units[&#39;flow_rate&#39;])
        return qty.Pressure(a0 + a1 * V + a2 * V ** 2, self._dest_units[&#39;pressure&#39;])


if __name__ == &#39;__main__&#39;:

    pump_curve = PumpCurve(dest_units={&#39;flow_rate&#39;: &#39;L/s&#39;, &#39;pressure&#39;: &#39;bar&#39;})
    pump_curve.add_measuring_points(
        points=[(0.0, 60.0), (2.4, 52.0), (4.2, 48.0), (6.0, 36.0)],
        units={&#39;flow_rate&#39;: &#39;m^3/h&#39;, &#39;pressure&#39;: &#39;m&#39;}
    )

    coeff1 = pump_curve.get_coefficients(units={&#39;pressure&#39;: &#39;Pa&#39;, &#39;flow_rate&#39;: &#39;m^3/s&#39;})
    print(coeff1)
    coeff2 = pump_curve.get_coefficients(units={&#39;pressure&#39;: &#39;bar&#39;, &#39;flow_rate&#39;: &#39;L/s&#39;})
    print(coeff2)

    graph_ = pump_curve.draw_pump_curve(
        V_initial=qty.VolumeFlowRate(0.0, &#39;m^3/h&#39;),
        V_final=qty.VolumeFlowRate(7.2, &#39;m^3/h&#39;),
        fig_size=(10, 8),
        dpi=150,
        num=100,
        V_max=qty.VolumeFlowRate(3.0, &#39;L/s&#39;),
        V_step=qty.VolumeFlowRate(0.5, &#39;L/s&#39;),
        p_max=qty.Pressure(8.0, &#39;bar&#39;),
        p_step=qty.Pressure(2.0, &#39;bar&#39;)
    )
    graph_.show()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pypeflow.utils.pump_curve.PumpCurve"><code class="flex name class">
<span>class <span class="ident">PumpCurve</span></span>
<span>(</span><span>dest_units)</span>
</code></dt>
<dd>
<section class="desc"><p>Create <em>PumpCurve</em> object.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>dest_units</code>: (<em>Dict[str, str]</em>)<br>
The measuring units in which the pump curve will be expressed. Keys:</p>
<ul>
<li>'flow_rate'</li>
<li>'pressure'</li>
</ul>
</li>
</ul></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class PumpCurve:

    def __init__(self, dest_units: Dict[str, str]):
        &#34;&#34;&#34;
        Create *PumpCurve* object.

        **Parameters:**

        - `dest_units`: (*Dict[str, str]*)&lt;br&gt;
        The measuring units in which the pump curve will be expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        self._meas_points: List[Tuple[qty.VolumeFlowRate, qty.Pressure]] = []
        self._dest_units: Dict[str, str] = dest_units
        self._coefficients: Optional[np.array] = None

    def add_measuring_points(self, points: List[Tuple[float, float]], units: Dict[str, str]):
        &#34;&#34;&#34;
        Add some data points taken from the pump curve in the data sheet. This will execute the curve fitting
        algorithm that approaches the pump curve with a 2nd order polynomial.

        **Parameters:**

        - `points`: (*List[Tuple[float, float]]*)&lt;br&gt;
        List of tuples. The 1st element of the tuple is flow rate, the 2nd element is pressure.
        - `units`: (*Dict[str, str]*)&lt;br&gt;
        Dictionary that contains the measuring units in which the values of the data points are expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        self._meas_points = [
            (qty.VolumeFlowRate(V, units[&#39;flow_rate&#39;]), qty.Pressure(p, units[&#39;pressure&#39;])) for V, p in points
        ]
        self._curve_fitting()

    def _curve_fitting(self):
        pf = PolyFit(
            x_data=[V(self._dest_units[&#39;flow_rate&#39;]) for V, _ in self._meas_points],
            y_data=[p(self._dest_units[&#39;pressure&#39;]) for _, p in self._meas_points],
            m=2
        )
        self._coefficients = pf.solve()

    def get_coefficients(self, units: Optional[Dict[str, str]] = None) -&gt; Optional[List[float]]:
        &#34;&#34;&#34;
        Get the coefficients of the 2nd order polynomial describing the pump curve.

        **Parameters:**

        - `units`: (*Optional[[Dict[str, str]]*)&lt;br&gt;
        Optional dictionary that contains the measuring units in which the returned coefficients must be expressed.
        Default is None, which means that the coefficients will be returned expressed in the measuring units passed in
        at the instantiation of the *PumpCurve* object. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        if units is not None:
            p_src = qty.Pressure(1.0, self._dest_units[&#39;pressure&#39;])
            V_src = qty.VolumeFlowRate(1.0, self._dest_units[&#39;flow_rate&#39;])
            p_des = p_src(units[&#39;pressure&#39;])
            V_des = V_src(units[&#39;flow_rate&#39;])
        else:
            p_des = 1.0
            V_des = 1.0
        a0 = self._coefficients[0] * p_des
        a1 = self._coefficients[1] * (p_des / V_des)
        a2 = self._coefficients[2] * (p_des / V_des ** 2)
        return [a0, a1, a2]

    def set_coefficients(self, coeff: Tuple[float, float, float], units: Dict[str, str]):
        &#34;&#34;&#34;
        Set the known coefficients of the 2nd order polynomial describing the pump curve.

        **Parameters:**

        - `coeff`: (*Tuple[float, float, float]*)&lt;br&gt;
        Tuple of 3 floats: a0, a1 and a2 as in the equation dp_pump = a0 + a1 * V + a2 * V **2
        - `units`: (*Dict[str, str]*)&lt;br&gt;
        Dictionary that contains the measuring units in which the pump coefficients are expressed. Keys:

            + &#39;flow_rate&#39;
            + &#39;pressure&#39;

        &#34;&#34;&#34;
        p_src = qty.Pressure(1.0, units[&#39;pressure&#39;])
        V_src = qty.VolumeFlowRate(1.0, units[&#39;flow_rate&#39;])
        p_des = p_src(self._dest_units[&#39;pressure&#39;])
        V_des = V_src(self._dest_units[&#39;flow_rate&#39;])
        a0 = coeff[0] * p_des
        a1 = coeff[1] * (p_des / V_des)
        a2 = coeff[2] * (p_des / V_des ** 2)
        self._coefficients = np.array([a0, a1, a2])

    def create_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, num: int = 50):
        &#34;&#34;&#34;
        Calculate the pump curve between an initial and final flow rate.

        **Parameters:**

        - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
        - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
        - `num`: (*int*) = number of calculation points (default = 50)

        **Returns:** (*Tuple[np.array, np.array]*)
        Tuple with 1st element a numpy array of the flow rates and 2nd element a numpy array of the corresponding
        pressures, both expressed in the desired measuring units set at instantiation of the *PumpCurve*-object.

        &#34;&#34;&#34;
        V_i = V_initial(self._dest_units[&#39;flow_rate&#39;])
        V_f = V_final(self._dest_units[&#39;flow_rate&#39;])
        V = np.linspace(V_i, V_f, num, endpoint=True)
        a0 = self._coefficients[0]; a1 = self._coefficients[1]; a2 = self._coefficients[2]
        p = a0 + a1 * V + a2 * V ** 2
        return V, p

    def draw_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, **kwargs):
        &#34;&#34;&#34;
        Draw the calculated pump curve.

        **Parameters:**

        - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
        - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
        - `kwargs`: optional keyword arguments
            + `fig_size`: (*Tuple[float, float]*) = the width and height of the figure in inches
            + `dpi`: (*int*) = dots per inch of the figure
            + `num`: (*int*) = number of calculated points to draw
            + `V_step`: (*quantities.VolumeFlowRate*) = step between ticks on the flow rate axis of the diagram
            + `V_max`: (*quantities.VolumeFlowRate*) = the maximum flow rate shown on the axis
            + `p_step`: (*quantities.Pressure*) = step between ticks on the pressure axis of the diagram
            + `p_max`: (*quantities.Pressure*) = maximum pressure shown on the axis
            + `working_point`: (*Tuple[qty.VolumeFlowRate, qty.Pressure]*) = working point of the pump (shown as a red
            dot on the diagram)

        **Returns:** (*nummath.graphing2.LineGraph*)&lt;br&gt;
        Call show() on the returned *LineGraph* object to show the diagram.
        &#34;&#34;&#34;
        if self._coefficients is not None:
            fig_size: Tuple[int, int] = kwargs.get(&#39;fig_size&#39;, (6, 4))
            dpi: int = kwargs.get(&#39;dpi&#39;, 96)
            num: int = kwargs.get(&#39;num&#39;, 50)
            V_step: qty.VolumeFlowRate = kwargs.get(&#39;V_step&#39;)
            V_max: qty.VolumeFlowRate = kwargs.get(&#39;V_max&#39;)
            p_step: qty.Pressure = kwargs.get(&#39;p_step&#39;)
            p_max: qty.Pressure = kwargs.get(&#39;p_max&#39;)
            working_point: Tuple[qty.VolumeFlowRate, qty.Pressure] = kwargs.get(&#39;working_point&#39;)
            V, p = self.create_pump_curve(V_initial, V_final, num)
            graph = LineGraph(fig_size=fig_size, dpi=dpi)
            graph.add_dataset(name=&#34;pump curve&#34;, x1_data=V, y1_data=p)
            if self._meas_points:
                graph.add_dataset(
                    name=&#34;measured points&#34;,
                    x1_data=[V(self._dest_units[&#39;flow_rate&#39;]) for V, _ in self._meas_points],
                    y1_data=[p(self._dest_units[&#39;pressure&#39;]) for _, p in self._meas_points],
                    layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;}
                )
            if working_point:
                graph.add_dataset(
                    name=&#34;working point&#34;,
                    x1_data=working_point[0](self._dest_units[&#39;flow_rate&#39;]),
                    y1_data=working_point[1](self._dest_units[&#39;pressure&#39;]),
                    layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;, &#39;color&#39;: &#39;red&#39;}
                )
            graph.x1.set_title(f&#39;flow rate [{self._dest_units[&#34;flow_rate&#34;]}]&#39;)
            if V_max is not None and V_step is not None:
                graph.x1.scale(
                    lim_down=0.0,
                    lim_up=V_max(self._dest_units[&#39;flow_rate&#39;]),
                    step_size=V_step(self._dest_units[&#39;flow_rate&#39;])
                )
            graph.y1.set_title(f&#39;pressure [{self._dest_units[&#34;pressure&#34;]}]&#39;)
            if p_max is not None and p_step is not None:
                graph.y1.scale(
                    lim_down=0.0,
                    lim_up=p_max(self._dest_units[&#39;pressure&#39;]),
                    step_size=p_step(self._dest_units[&#39;pressure&#39;])
                )
            return graph

    def pump_head(self, V: qty.VolumeFlowRate) -&gt; qty.Pressure:
        &#34;&#34;&#34;
        Get the pump head (*quantities.Pressure*) if the flow rate (*quantities.VolumeFlowRate*) is given.

        &#34;&#34;&#34;
        a0 = self._coefficients[0]
        a1 = self._coefficients[1]
        a2 = self._coefficients[2]
        V = V(self._dest_units[&#39;flow_rate&#39;])
        return qty.Pressure(a0 + a1 * V + a2 * V ** 2, self._dest_units[&#39;pressure&#39;])</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="pypeflow.utils.pump_curve.PumpCurve.add_measuring_points"><code class="name flex">
<span>def <span class="ident">add_measuring_points</span></span>(<span>self, points, units)</span>
</code></dt>
<dd>
<section class="desc"><p>Add some data points taken from the pump curve in the data sheet. This will execute the curve fitting
algorithm that approaches the pump curve with a 2nd order polynomial.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>points</code>: (<em>List[Tuple[float, float]]</em>)<br>
List of tuples. The 1st element of the tuple is flow rate, the 2nd element is pressure.</li>
<li>
<p><code>units</code>: (<em>Dict[str, str]</em>)<br>
Dictionary that contains the measuring units in which the values of the data points are expressed. Keys:</p>
<ul>
<li>'flow_rate'</li>
<li>'pressure'</li>
</ul>
</li>
</ul></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_measuring_points(self, points: List[Tuple[float, float]], units: Dict[str, str]):
    &#34;&#34;&#34;
    Add some data points taken from the pump curve in the data sheet. This will execute the curve fitting
    algorithm that approaches the pump curve with a 2nd order polynomial.

    **Parameters:**

    - `points`: (*List[Tuple[float, float]]*)&lt;br&gt;
    List of tuples. The 1st element of the tuple is flow rate, the 2nd element is pressure.
    - `units`: (*Dict[str, str]*)&lt;br&gt;
    Dictionary that contains the measuring units in which the values of the data points are expressed. Keys:

        + &#39;flow_rate&#39;
        + &#39;pressure&#39;

    &#34;&#34;&#34;
    self._meas_points = [
        (qty.VolumeFlowRate(V, units[&#39;flow_rate&#39;]), qty.Pressure(p, units[&#39;pressure&#39;])) for V, p in points
    ]
    self._curve_fitting()</code></pre>
</details>
</dd>
<dt id="pypeflow.utils.pump_curve.PumpCurve.create_pump_curve"><code class="name flex">
<span>def <span class="ident">create_pump_curve</span></span>(<span>self, V_initial, V_final, num=50)</span>
</code></dt>
<dd>
<section class="desc"><p>Calculate the pump curve between an initial and final flow rate.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>V_initial</code>: (<em>quantities.VolumeFlowRate</em>) = initial flow rate</li>
<li><code>V_final</code>: (<em>quantities.VolumeFlowRate</em>) = final flow rate</li>
<li><code>num</code>: (<em>int</em>) = number of calculation points (default = 50)</li>
</ul>
<p><strong>Returns:</strong> (<em>Tuple[np.array, np.array]</em>)
Tuple with 1st element a numpy array of the flow rates and 2nd element a numpy array of the corresponding
pressures, both expressed in the desired measuring units set at instantiation of the <em>PumpCurve</em>-object.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, num: int = 50):
    &#34;&#34;&#34;
    Calculate the pump curve between an initial and final flow rate.

    **Parameters:**

    - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
    - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
    - `num`: (*int*) = number of calculation points (default = 50)

    **Returns:** (*Tuple[np.array, np.array]*)
    Tuple with 1st element a numpy array of the flow rates and 2nd element a numpy array of the corresponding
    pressures, both expressed in the desired measuring units set at instantiation of the *PumpCurve*-object.

    &#34;&#34;&#34;
    V_i = V_initial(self._dest_units[&#39;flow_rate&#39;])
    V_f = V_final(self._dest_units[&#39;flow_rate&#39;])
    V = np.linspace(V_i, V_f, num, endpoint=True)
    a0 = self._coefficients[0]; a1 = self._coefficients[1]; a2 = self._coefficients[2]
    p = a0 + a1 * V + a2 * V ** 2
    return V, p</code></pre>
</details>
</dd>
<dt id="pypeflow.utils.pump_curve.PumpCurve.draw_pump_curve"><code class="name flex">
<span>def <span class="ident">draw_pump_curve</span></span>(<span>self, V_initial, V_final, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Draw the calculated pump curve.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>V_initial</code>: (<em>quantities.VolumeFlowRate</em>) = initial flow rate</li>
<li><code>V_final</code>: (<em>quantities.VolumeFlowRate</em>) = final flow rate</li>
<li><code>kwargs</code>: optional keyword arguments<ul>
<li><code>fig_size</code>: (<em>Tuple[float, float]</em>) = the width and height of the figure in inches</li>
<li><code>dpi</code>: (<em>int</em>) = dots per inch of the figure</li>
<li><code>num</code>: (<em>int</em>) = number of calculated points to draw</li>
<li><code>V_step</code>: (<em>quantities.VolumeFlowRate</em>) = step between ticks on the flow rate axis of the diagram</li>
<li><code>V_max</code>: (<em>quantities.VolumeFlowRate</em>) = the maximum flow rate shown on the axis</li>
<li><code>p_step</code>: (<em>quantities.Pressure</em>) = step between ticks on the pressure axis of the diagram</li>
<li><code>p_max</code>: (<em>quantities.Pressure</em>) = maximum pressure shown on the axis</li>
<li><code>working_point</code>: (<em>Tuple[qty.VolumeFlowRate, qty.Pressure]</em>) = working point of the pump (shown as a red
dot on the diagram)</li>
</ul>
</li>
</ul>
<p><strong>Returns:</strong> (<em>nummath.graphing2.LineGraph</em>)<br>
Call show() on the returned <em>LineGraph</em> object to show the diagram.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def draw_pump_curve(self, V_initial: qty.VolumeFlowRate, V_final: qty.VolumeFlowRate, **kwargs):
    &#34;&#34;&#34;
    Draw the calculated pump curve.

    **Parameters:**

    - `V_initial`: (*quantities.VolumeFlowRate*) = initial flow rate
    - `V_final`: (*quantities.VolumeFlowRate*) = final flow rate
    - `kwargs`: optional keyword arguments
        + `fig_size`: (*Tuple[float, float]*) = the width and height of the figure in inches
        + `dpi`: (*int*) = dots per inch of the figure
        + `num`: (*int*) = number of calculated points to draw
        + `V_step`: (*quantities.VolumeFlowRate*) = step between ticks on the flow rate axis of the diagram
        + `V_max`: (*quantities.VolumeFlowRate*) = the maximum flow rate shown on the axis
        + `p_step`: (*quantities.Pressure*) = step between ticks on the pressure axis of the diagram
        + `p_max`: (*quantities.Pressure*) = maximum pressure shown on the axis
        + `working_point`: (*Tuple[qty.VolumeFlowRate, qty.Pressure]*) = working point of the pump (shown as a red
        dot on the diagram)

    **Returns:** (*nummath.graphing2.LineGraph*)&lt;br&gt;
    Call show() on the returned *LineGraph* object to show the diagram.
    &#34;&#34;&#34;
    if self._coefficients is not None:
        fig_size: Tuple[int, int] = kwargs.get(&#39;fig_size&#39;, (6, 4))
        dpi: int = kwargs.get(&#39;dpi&#39;, 96)
        num: int = kwargs.get(&#39;num&#39;, 50)
        V_step: qty.VolumeFlowRate = kwargs.get(&#39;V_step&#39;)
        V_max: qty.VolumeFlowRate = kwargs.get(&#39;V_max&#39;)
        p_step: qty.Pressure = kwargs.get(&#39;p_step&#39;)
        p_max: qty.Pressure = kwargs.get(&#39;p_max&#39;)
        working_point: Tuple[qty.VolumeFlowRate, qty.Pressure] = kwargs.get(&#39;working_point&#39;)
        V, p = self.create_pump_curve(V_initial, V_final, num)
        graph = LineGraph(fig_size=fig_size, dpi=dpi)
        graph.add_dataset(name=&#34;pump curve&#34;, x1_data=V, y1_data=p)
        if self._meas_points:
            graph.add_dataset(
                name=&#34;measured points&#34;,
                x1_data=[V(self._dest_units[&#39;flow_rate&#39;]) for V, _ in self._meas_points],
                y1_data=[p(self._dest_units[&#39;pressure&#39;]) for _, p in self._meas_points],
                layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;}
            )
        if working_point:
            graph.add_dataset(
                name=&#34;working point&#34;,
                x1_data=working_point[0](self._dest_units[&#39;flow_rate&#39;]),
                y1_data=working_point[1](self._dest_units[&#39;pressure&#39;]),
                layout={&#39;marker&#39;: &#39;o&#39;, &#39;linestyle&#39;: &#39;None&#39;, &#39;color&#39;: &#39;red&#39;}
            )
        graph.x1.set_title(f&#39;flow rate [{self._dest_units[&#34;flow_rate&#34;]}]&#39;)
        if V_max is not None and V_step is not None:
            graph.x1.scale(
                lim_down=0.0,
                lim_up=V_max(self._dest_units[&#39;flow_rate&#39;]),
                step_size=V_step(self._dest_units[&#39;flow_rate&#39;])
            )
        graph.y1.set_title(f&#39;pressure [{self._dest_units[&#34;pressure&#34;]}]&#39;)
        if p_max is not None and p_step is not None:
            graph.y1.scale(
                lim_down=0.0,
                lim_up=p_max(self._dest_units[&#39;pressure&#39;]),
                step_size=p_step(self._dest_units[&#39;pressure&#39;])
            )
        return graph</code></pre>
</details>
</dd>
<dt id="pypeflow.utils.pump_curve.PumpCurve.get_coefficients"><code class="name flex">
<span>def <span class="ident">get_coefficients</span></span>(<span>self, units=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Get the coefficients of the 2nd order polynomial describing the pump curve.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>units</code>: (<em>Optional[[Dict[str, str]]</em>)<br>
Optional dictionary that contains the measuring units in which the returned coefficients must be expressed.
Default is None, which means that the coefficients will be returned expressed in the measuring units passed in
at the instantiation of the <em>PumpCurve</em> object. Keys:</p>
<ul>
<li>'flow_rate'</li>
<li>'pressure'</li>
</ul>
</li>
</ul></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_coefficients(self, units: Optional[Dict[str, str]] = None) -&gt; Optional[List[float]]:
    &#34;&#34;&#34;
    Get the coefficients of the 2nd order polynomial describing the pump curve.

    **Parameters:**

    - `units`: (*Optional[[Dict[str, str]]*)&lt;br&gt;
    Optional dictionary that contains the measuring units in which the returned coefficients must be expressed.
    Default is None, which means that the coefficients will be returned expressed in the measuring units passed in
    at the instantiation of the *PumpCurve* object. Keys:

        + &#39;flow_rate&#39;
        + &#39;pressure&#39;

    &#34;&#34;&#34;
    if units is not None:
        p_src = qty.Pressure(1.0, self._dest_units[&#39;pressure&#39;])
        V_src = qty.VolumeFlowRate(1.0, self._dest_units[&#39;flow_rate&#39;])
        p_des = p_src(units[&#39;pressure&#39;])
        V_des = V_src(units[&#39;flow_rate&#39;])
    else:
        p_des = 1.0
        V_des = 1.0
    a0 = self._coefficients[0] * p_des
    a1 = self._coefficients[1] * (p_des / V_des)
    a2 = self._coefficients[2] * (p_des / V_des ** 2)
    return [a0, a1, a2]</code></pre>
</details>
</dd>
<dt id="pypeflow.utils.pump_curve.PumpCurve.pump_head"><code class="name flex">
<span>def <span class="ident">pump_head</span></span>(<span>self, V)</span>
</code></dt>
<dd>
<section class="desc"><p>Get the pump head (<em>quantities.Pressure</em>) if the flow rate (<em>quantities.VolumeFlowRate</em>) is given.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def pump_head(self, V: qty.VolumeFlowRate) -&gt; qty.Pressure:
    &#34;&#34;&#34;
    Get the pump head (*quantities.Pressure*) if the flow rate (*quantities.VolumeFlowRate*) is given.

    &#34;&#34;&#34;
    a0 = self._coefficients[0]
    a1 = self._coefficients[1]
    a2 = self._coefficients[2]
    V = V(self._dest_units[&#39;flow_rate&#39;])
    return qty.Pressure(a0 + a1 * V + a2 * V ** 2, self._dest_units[&#39;pressure&#39;])</code></pre>
</details>
</dd>
<dt id="pypeflow.utils.pump_curve.PumpCurve.set_coefficients"><code class="name flex">
<span>def <span class="ident">set_coefficients</span></span>(<span>self, coeff, units)</span>
</code></dt>
<dd>
<section class="desc"><p>Set the known coefficients of the 2nd order polynomial describing the pump curve.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>coeff</code>: (<em>Tuple[float, float, float]</em>)<br>
Tuple of 3 floats: a0, a1 and a2 as in the equation dp_pump = a0 + a1 * V + a2 * V **2</li>
<li>
<p><code>units</code>: (<em>Dict[str, str]</em>)<br>
Dictionary that contains the measuring units in which the pump coefficients are expressed. Keys:</p>
<ul>
<li>'flow_rate'</li>
<li>'pressure'</li>
</ul>
</li>
</ul></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_coefficients(self, coeff: Tuple[float, float, float], units: Dict[str, str]):
    &#34;&#34;&#34;
    Set the known coefficients of the 2nd order polynomial describing the pump curve.

    **Parameters:**

    - `coeff`: (*Tuple[float, float, float]*)&lt;br&gt;
    Tuple of 3 floats: a0, a1 and a2 as in the equation dp_pump = a0 + a1 * V + a2 * V **2
    - `units`: (*Dict[str, str]*)&lt;br&gt;
    Dictionary that contains the measuring units in which the pump coefficients are expressed. Keys:

        + &#39;flow_rate&#39;
        + &#39;pressure&#39;

    &#34;&#34;&#34;
    p_src = qty.Pressure(1.0, units[&#39;pressure&#39;])
    V_src = qty.VolumeFlowRate(1.0, units[&#39;flow_rate&#39;])
    p_des = p_src(self._dest_units[&#39;pressure&#39;])
    V_des = V_src(self._dest_units[&#39;flow_rate&#39;])
    a0 = coeff[0] * p_des
    a1 = coeff[1] * (p_des / V_des)
    a2 = coeff[2] * (p_des / V_des ** 2)
    self._coefficients = np.array([a0, a1, a2])</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#pump-curve-fitting-and-drawing">Pump curve fitting and drawing</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pypeflow.utils" href="index.html">pypeflow.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pypeflow.utils.pump_curve.PumpCurve" href="#pypeflow.utils.pump_curve.PumpCurve">PumpCurve</a></code></h4>
<ul class="">
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.add_measuring_points" href="#pypeflow.utils.pump_curve.PumpCurve.add_measuring_points">add_measuring_points</a></code></li>
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.create_pump_curve" href="#pypeflow.utils.pump_curve.PumpCurve.create_pump_curve">create_pump_curve</a></code></li>
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.draw_pump_curve" href="#pypeflow.utils.pump_curve.PumpCurve.draw_pump_curve">draw_pump_curve</a></code></li>
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.get_coefficients" href="#pypeflow.utils.pump_curve.PumpCurve.get_coefficients">get_coefficients</a></code></li>
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.pump_head" href="#pypeflow.utils.pump_curve.PumpCurve.pump_head">pump_head</a></code></li>
<li><code><a title="pypeflow.utils.pump_curve.PumpCurve.set_coefficients" href="#pypeflow.utils.pump_curve.PumpCurve.set_coefficients">set_coefficients</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.5</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>